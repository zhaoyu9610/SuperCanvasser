<!doctype html>
{% load static %}
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="">

    <title>Super Canvasser Landing Page</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" type="text/css" href="{% static 'supercanvassercampaign.css' %}">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
          integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">


    <script>
    var roles = new Array();
    var users = {{users|safe}};
    var parameters = {{settings|safe}};
    $( document ).ready(function() {
        {% for val in role %}
            roles.push({{val|yesno:"true,false"}});
        {% endfor %}

         if(roles[0] == true && roles[1] == false && roles[2] == false){
         	$("#showManager").hide();
         	$("#showCanvasser").hide();
         	$("#showAdmin").show();
         }
         else if(roles[0] == true && roles[1] == true){
            $("#showManager").show();
            $("#showCanvasser").show();
         }
         else if(roles[0] == true && roles[1] == false){
            $("#showManager").hide();
            $("#showCanvasser").show();
         }
         else if(roles[0] == false && roles[1] == true){
            $("#showManager").show();
            $("#showCanvasser").hide();
         }
    });

    $( document ).ready(function() {
        for(var i = 0; i <users.length;i++){
            var canTrue = "checked";
            var manTrue = "checked";
            var adminTrue = "checked";
            if(users[i].canvasser == false)
                canTrue = "";
            if(users[i].manager == false)
                manTrue = "";
            if(users[i].admin == false)
                adminTrue = "";
            $("#addToUsers").append("<tr>"+"<td>"+ users[i].id +"</td>"+"<td>"+ users[i].email +"</td>"+"<td id = 'adminTd'>"
            + "<input id = 'adminbox' type='checkbox'" + adminTrue +">" +"</td>"+"<td id = 'canvasserTd'>"
            + "<input id = 'canvasserbox' type='checkbox'" + canTrue +">" +"</td>"+"<td id = 'managerTd'>"
            + "<input id = 'managerbox' type='checkbox'" + manTrue +">" +"</td>"+"</tr>");
        }

    });

    $( document ).ready(function() {
        for(var i = 0; i <parameters.length;i++){

            $("#addToParameters").append("<tr>"+"<td>"+ parameters[i].name +"</td>"+"<td id = 'paraVal'>"
            + "<input type='text' value = " +parameters[i].value+">" +"</td>"+"</tr>");
        }

    });

    var allUsers = new Array();
    $(document).ready(function () {
        $("#updateUsers").click(function () {

        $('#adminTable tr').each(function(){
            $(this).find('td').each(function(){
            alert($(this).html());
                <!--if(!(isNaN($(this).html()))){-->
                    <!--var a = {"id":$(this).html()}-->
                    <!--alert(JSON.stringify(a));-->
                <!--}-->
                <!--else{-->
                    <!--var a = {"adm-->
                <!--}-->

             })
        })

            	$.ajax({
                type: "POST",
                url: "/api/update_account",
                contentType: "application/json",
                dataType: "json",
                data: JSON.stringify({"users": [{"id":1, "admin":false, }]}),
                success: function (result) {
                    alert(result);

                }
            });

        });
    });



    $(document).ready(function() {
        $("#submit").click(function () {


    			$.ajax({
                type: "POST",
                url: "/api/update_account",
                contentType: "application/json",
                dataType: "json",
                data: JSON.stringify({"email": $("#changeUser").val(), "password": $("#changePassword").val()}),
                success: function (result) {
                    alert(result);

                }
            });
        });
    });

    $(document).ready(function () {
        $("#logout").click(function () {
            $.ajax({
                type: "GET",
                url: "/api/logout",
                success: function (result) {
                    window.location.href ="/";
                }
            });
        });
    });



    </script>


</head>


<body>
<div class="container">

    <nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top">
        <div class="container">
            <div class="navbar-header">

                <div class="collapse navbar-collapse" id="menu">
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item" id="showManager"><a class="nav-link" href="/campaigns">Manager</a></li>
                        <li class="nav-item" id="showCanvasser"><a class="nav-link" href="/assignments">Canvasser</a>
                        </li>
                        <li class="nav-item" id="showAdmin"><a class="nav-link" href="/admin">Admin</a></li>
                    </ul>
                </div>

                <button class="navbar-toggler" type="button" data-toggle="collapse">

                </button>
            </div>

            <div class="collapse navbar-collapse" id="menu">
                <ul class="navbar-nav ml-auto">
                    <li class="nav-item"><a class="nav-link" href="/admin">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="/account">Profile</a></li>
                    <li id="logout" class="nav-item"><a class="nav-link" href="#">Sign out</a></li>
                </ul>
            </div>
        </div>
    </nav>
</div>

<div class="jumbotron">
    <div class="flex-container">
                <div class="jumbotron">
                    <table class="table table-hover" id="adminTable">
                        <thead class="thead-dark">
                        <tr>
                            <th scope="col">ID#</th>
                            <th scope="col">User Email</th>
                            <th scope="col">Admin</th>
                            <th scope="col">Canvasser</th>
                            <th scope="col">Manager</th>
                        </tr>
                        </thead>
                        <tbody id="addToUsers">
                        </tbody>
                    </table>
                    <button id="updateUsers" class="btn btn-block btn-dark btn-secondary">Save changes</button>
                </div>
        <div class ="space"></div>
                    <div class="jumbotron">

                        <table class="table table-hover" id="camTable">
                            <thead class="thead-dark">
                            <tr>
                                <th scope="col">Parameters</th>
                                <th scope="col">Values</th>
                            </tr>
                            </thead>
                            <tbody id="addToParameters">
                            </tbody>
                        </table>
                        <button id="updateParameters" class="btn btn-block btn-dark btn-secondary">Save changes</button>
                    </div>

        </div>

    </div>


    <!--
      ================================================== -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
            integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
            crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
            integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
            crossorigin="anonymous"></script>
</body>
</html>